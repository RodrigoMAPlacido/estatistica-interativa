/* =========================================================
   ESTAT√çSTICA INTERATIVA ‚Äî CSS PRINCIPAL (DEPURADO E MODULAR)
   ========================================================= */

/* =========================================================
   1. VARI√ÅVEIS GLOBAIS
   ========================================================= */
:root {
  --fg:#111827;
  --muted:#4b5563;
  --accent:#1f2937;
  --accentFg:#fff;
  --text:#222;

  --max-width:900px;
  --content-width:850px;

  --border-light:#e5e7eb;
  --border-medium:#6b7280;
}

/* =========================================================
   2. BASE / RESET
   ========================================================= */
html, body { height:100%; }
body {
  color:var(--text);
  background:#fff;
  -webkit-text-size-adjust:100%;
}
body.loading { visibility:hidden; opacity:0; }
body.ready { visibility:visible; opacity:1; transition:opacity .35s ease; }

/* =========================================================
   3. CAPA (index-page)
   ========================================================= */
body.index-page {
  margin:0; padding:0;
  width:100%; max-width:100%;
  background:#fff;
  overflow:hidden;
  height:100vh;
  touch-action:none;
  overscroll-behavior:none;
}
.hero {
  position:relative;
  z-index:1;
  height:100%;
  display:grid;
  place-items:center;
  padding:24px;
}

/* Bot√µes e autoria */
.card { text-align:center; padding:40px 28px; border-radius:14px; }
.cta {
  display:inline-block;
  padding:12px 18px;
  border-radius:10px;
  background:var(--accent);
  color:var(--accentFg);
  text-decoration:none;
  font-weight:700;
  transition:transform .12s ease, opacity .12s ease;
}
.cta:hover { transform:translateY(-1px); opacity:.95; }
.cta:active { transform:none; opacity:.9; }
.autor {
  font-size:14px; color:#555; margin-top:4px; font-style:italic;
  text-align:right; max-width:260px; margin-left:auto;
}

/* =========================================================
   4. NAVEGA√á√ÉO ENTRE CAP√çTULOS
   ========================================================= */
.nav-links {
  margin:60px auto 0;
  padding-top:25px;
  border-top:1px solid #bfbfbf;
  display:flex;
  justify-content:space-between;
  align-items:center;
  max-width:var(--max-width);
  font-size:16px;
  font-family:Georgia,serif;
}
.nav-links a {
  color:#333; text-decoration:none;
  padding:6px 8px; border-bottom:1px solid transparent;
}
.nav-links a:hover { border-bottom-color:#000; }
.nav-links .anterior { flex:1; text-align:left; }
.nav-links .sumario  { flex:1; text-align:center; }
.nav-links .proximo  { flex:1; text-align:right; }
/* =========================================================
   4.1 NAVEGA√á√ÉO ENTRE CAP√çTULOS ‚Äî AJUSTE MOBILE
   ========================================================= */
@media (max-width: 768px) {

  .nav-links {
    margin-top: 10px;
    padding-top: 5px;
    font-size: 1.1rem;              /* reduz o tamanho da fonte */
    gap: 4px;                      /* reduz o espa√ßamento */
  }

  .nav-links a {
    padding: 4px 4px;              /* diminui a √°rea dos links */
  }

  .nav-links .anterior,
  .nav-links .sumario,
  .nav-links .proximo {
    flex: 1;
    text-align: center;
  }

  /* opcional: reduz leve espa√ßamento vertical */
  .nav-links .anterior { text-align: left; }
  .nav-links .proximo  { text-align: right; }
}

/* =========================================================
   5. LAYOUT DO LIVRO (body.textbook)
   ========================================================= */
body.textbook {
  max-width:var(--max-width);
  margin:0 auto;
  padding:60px 32px 40px;
  line-height:1.7;
  font-family:et-book,"Palatino Linotype",serif;
  background:#fff;
}

/* T√≠tulos */
body.textbook h1 {
  font-size:2.6rem; font-weight:400; line-height:1.2; margin:0 0 1.8rem;
}
body.textbook h2 {
  font-size:1.9rem; font-weight:400; line-height:1.35; margin:3.5rem 0 1.2rem;
}
body.textbook h3 {
  font-size:1.4rem; font-weight:700; line-height:1.35; margin:2.3rem 0 1rem 1rem;
}
body.textbook .subtitle {
  font-size:1rem; font-weight:700; color:#555;
  margin:1rem 0 0; letter-spacing:.04em; text-transform:uppercase;
}

/* Texto e listas */
body.textbook p, body.textbook li {
  max-width:var(--content-width);
  text-align:justify;
}
body.textbook p { font-size:1.13rem; margin:0 0 1.4rem; }
body.textbook ul {
  margin:0 0 1rem 1.2rem; padding:0;
}
body.textbook ol {
  margin:2rem 2.5rem 2rem; padding:0;
}
body.textbook li { margin:0 0 1rem; }
body.textbook .newthought {
  font-variant:small-caps; font-size:1.28rem; letter-spacing:.03em;
}

/* =========================================================
   6. FIGURAS E SVGs (n√£o-KG)
   ========================================================= */
figure.figure,
.figure {
  display:block;
  margin:1.2rem 0 0 1.2rem;
  text-align:center;
  max-width:var(--content-width);
}

figure.figure > img,
figure.figure > svg,
.figure > img,
.figure > svg {
  display: block;
  margin: 0 auto;
  width: 50%;              /* reduz tamanho em ~10% no desktop */
  max-width: 700px;        /* trava um teto confort√°vel */
  height: auto;

  /* Nitidez e renderiza√ß√£o vetorial */
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
  text-rendering: geometricPrecision;
  shape-rendering: geometricPrecision;
  vector-effect: non-scaling-stroke;
  backface-visibility: hidden;
}


figure.figure > figcaption,
.figure > figcaption {
  font-style:italic;
  font-size:1.3rem;
  margin-top:.1rem;
  color:#444;
}
/* =========================================================
   7. TABELAS ‚Äî AJUSTE AUTOM√ÅTICO E RESPONSIVO
   ========================================================= */
figure.figure.table {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 2rem auto;
  overflow-x: auto;
}

figure.figure.table table {
  border-collapse: collapse;
  table-layout: auto;            /* permite colunas ajustarem √† largura */
  width: 90%;                   /* ocupa todo o container */
  max-width: 100%;
  font-size: 1.05rem;
  margin: 1.5rem auto;
  word-wrap: break-word;
}

figure.figure.table th,
figure.figure.table td {
  padding: 8px 10px;
  border-bottom: 1px solid var(--border-light);
  text-align: center;
  line-height: 1.45;
  white-space: normal;           /* permite quebra autom√°tica */
}

figure.figure.table thead th {
  font-weight: 600;
  border-bottom: 2px solid var(--border-medium);
  hyphens: auto;                 /* quebra de s√≠labas */
}

figure.figure.table figcaption {
  display: block;
  margin: 0.6rem auto 0;
  text-align: center;
  font-style: italic;
  color: var(--muted);
  font-size: 0.9rem;
  max-width: 95%;
}

/* =========================================================
   TABELAS ‚Äî MOBILE
   ========================================================= */
@media (max-width: 768px) {
  figure.figure.table {
    width: 100%;
    overflow-x: hidden;          /* remove scroll horizontal */
    margin: 1.5rem auto;
  }

  figure.figure.table table {
    font-size: 0.8rem;
    table-layout: fixed;         /* for√ßa colunas mais estreitas */
    word-break: break-word;
  }

  figure.figure.table th,
  figure.figure.table td {
    padding: 6px 4px;
    white-space: normal;
  }

  figure.figure.table thead th {
    font-size: 0.7rem;
  }
}

/* =========================================================
   8. KGJS E KATEX
   ========================================================= */
.kg-container {
  --kg-max-width: var(--content-width);
  --kg-padding: 8px 6px;
  width: 100%;
  margin: 0 auto;
  padding: var(--kg-padding);
  background: #fff;
  border-radius: 6px;

  /* üîß impede que o scroll do mouse "prenda" dentro do KG */
  overflow: visible;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: auto;
  pointer-events: auto;
}

.kg-container canvas,
.kg-container svg,
.kg-container img {
  max-width:100%;
  width:100% !important;
  height:auto;
  display:block;
}

/* KaTeX */
body.textbook .katex { font-size:1.2em; }
body.textbook .katex-display { font-size:1.2em; margin:0 0; }

/* KG wrapper */
.kg-wrapper {
  display:flex;
  justify-content:center;
  align-items:center;
  width:100%;
  max-width:620px;
  margin:0 0 0 0;
}

/* =========================================================
   9. VERS√ïES RESPONSIVAS DE KG (mobile x desktop)
   ========================================================= */

/* Esconde por padr√£o ambos */
.kg-mobile,
.kg-desktop {
  display: none;
}

/* Mostra a vers√£o desktop */
@media (min-width: 769px) {
  .kg-desktop {
    display: block;
  }
}

/* Mostra a vers√£o mobile */
@media (max-width: 768px) {
  .kg-mobile {
    display: block;
  }
}

/* =========================================================
   10. RESPONSIVO (mobile)
   ========================================================= */
@media (max-width:768px) {
  html { font-size:12px; }
  body.textbook { max-width:100%; padding:10px 10px; line-height:1.5; }

  body.textbook h1 { font-size:1.8rem; line-height:1.22; margin:0 0 .7rem; }
  body.textbook h2 { font-size:1.6rem; line-height:1.24; margin:1.1rem 0 .5rem; }
  body.textbook h3 { font-size:1rem; margin:2.5rem .5rem 1rem; }

  body.textbook p,
  body.textbook ul {
    font-size:.9rem;
    margin-bottom:.75rem;
  }
  body.textbook ol {
    font-size:.9rem;
    margin: 2rem 0.3rem 2rem 1.5rem;
  }

/* =========================================================
   FIGURAS E ANIMA√á√ïES SVG ‚Äî RESPONSIVAS
   ========================================================= */

/* regra geral */
figure {
  display: block;
  width: 100%;
  max-width: 100%;
  margin: 1.5rem auto;
  text-align: center;
}

/* imagens e SVGs dentro da figure */
figure img,
figure svg {
  display: block;
  width: 100%;
  height: auto;
  max-width: 100%;
  margin: 0 auto;
}

/* =====================================
   AJUSTE FINO APENAS PARA O MOBILE
   ===================================== */
@media (max-width: 768px) {

  /* ===== FIGURAS E SVGs ===== */
  figure {
    margin: 1.2rem 0;
    padding: 0;
  }

  figure img,
  figure svg {
    width: 95vw;                 /* ocupa quase toda a viewport */
    max-width: none;
    position: relative;
    left: 50%;
    transform: translateX(-50%); /* centraliza perfeitamente */
  }

  /* ===== KGJS (layout especial no mobile) ===== */
  .kg-wrapper.kg-mobile {
    width: 125%;
    max-width: none;
    margin: 1.2rem auto 2.5rem;
    position: relative;
    left: -28.5%;
    transform: none;
  }


  /* ===== KaTeX ===== */
  body.textbook .katex,
  body.textbook .katex-display {
    font-size: 1em !important;     /* reduz proporcionalmente */
    overflow-wrap: anywhere;
  }
}

}

/* =========================================================
   11. BOT√ïES DE SCROLL (mobile)
   ========================================================= */
.scroll-buttons {
  position:fixed;
  bottom:calc(16px + env(safe-area-inset-bottom));
  right:16px;
  display:flex;
  flex-direction:column;
  gap:8px;
  z-index:1000;
  opacity:0;
  visibility:hidden;
  transform:translateY(6px);
  transition:opacity .25s ease, visibility .25s ease, transform .25s ease;
}
.scroll-buttons.show { opacity:1; visibility:visible; transform:none; }
.scroll-buttons button {
  width:44px; height:44px;
  border:1px solid rgba(255,255,255,.12);
  border-radius:8px;
  background:rgba(31,41,55,.55);
  color:var(--accentFg);
  font-size:1.15rem;
  font-weight:700;
  display:grid;
  place-items:center;
  line-height:1;
  padding:0;
  box-shadow:0 1px 2px rgba(0,0,0,.06);
  opacity:.95;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  transition:opacity .2s ease, transform .2s ease, box-shadow .2s ease;
}
.scroll-buttons button:hover { opacity:1; }
.scroll-buttons button:active { transform:translateY(1px); box-shadow:none; }
@media (min-width:769px) { .scroll-buttons { display:none; } }
@media (prefers-reduced-motion:reduce) {
  .scroll-buttons,
  .scroll-buttons.show,
  .scroll-buttons button { transition:none !important; }
}
