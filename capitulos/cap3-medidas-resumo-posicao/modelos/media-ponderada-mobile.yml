schema: EconSchema
aspectRatio: 1.6

params:
  # Valores individuais (pessoas) - continuam dragáveis nas barras
  - name: x_1
    value: 9
    min: 0
    max: 10
    round: 0.1

  - name: x_2
    value: 8
    min: 0
    max: 10
    round: 0.1

  - name: x_3
    value: 7
    min: 0
    max: 10
    round: 0.1

  - name: x_4
    value: 10
    min: 0
    max: 10
    round: 0.1


  # Frequências / pesos associados a cada valor
  - name: w_1
    value: 4
    min: 0
    max: 5
    round: 0.1

  - name: w_2
    value: 3
    min: 0
    max: 5
    round: 0.1

  - name: w_3
    value: 2
    min: 0
    max: 5
    round: 0.1

  - name: w_4
    value: 1
    min: 0
    max: 5
    round: 0.1


calcs:
  # Soma dos pesos (frequências)
  totalF: "(params.w_1 + params.w_2 + params.w_3 + params.w_4)"

  # Média ponderada: sum(x_i f_i) / sum(f_i)
  weightedMean: "((params.x_1*params.w_1) + (params.x_2*params.w_2) + (params.x_3*params.w_3) + (params.x_4*params.w_4))/(calcs.totalF)"

colors:
  ink: "'#111827'"
  grid: "'#e5e7eb'"

layout:
  OneWideGraphPlusSidebar:
    graph:
      xAxis:
        min: 0
        max: 5.5
        ticks: 0
        show: false
      yAxis:
        min: 0
        max: 11
        ticks: 6

      objects:
        # ---------------------------
        # BARRAS DRAGGABLE (VALORES x_i)
        # cada barra representa o valor x_i,
        # arrastável no eixo y
        # ---------------------------
        - Rectangle:
            x1: 0.7
            x2: 1.3
            y1: 0.3
            y2: params.x_1
            fill: colors.ink
            opacity: 1
            drag:
              - directions: y
                param: x_1
                expression: "(drag.y)"

        - Rectangle:
            x1: 1.7
            x2: 2.3
            y1: 0.3
            y2: params.x_2
            fill: colors.ink
            opacity: 1
            drag:
              - directions: y
                param: x_2
                expression: "(drag.y)"

        - Rectangle:
            x1: 2.7
            x2: 3.3
            y1: 0.3
            y2: params.x_3
            fill: colors.ink
            opacity: 1
            drag:
              - directions: y
                param: x_3
                expression: "(drag.y)"

        - Rectangle:
            x1: 3.7
            x2: 4.3
            y1: 0.3
            y2: params.x_4
            fill: colors.ink
            opacity: 1
            drag:
              - directions: y
                param: x_4
                expression: "(drag.y)"


        # ---------------------------
        # LINHA DA MÉDIA PONDERADA
        # (horizontal em y = weightedMean)
        # ---------------------------
        - Segment:
            a: [0, calcs.weightedMean]
            b: [6.5, calcs.weightedMean]
            strokeWidth: 3
            color: "'#64748b'"

        - Label:
            coordinates: [4.6,calcs.weightedMean + 0.7]
            text: "`\\\\mathbf{Média}\\\\ \\\\\\\\ \\\\bf{Pond.} = ${calcs.weightedMean.toFixed(2)}`"
            bgcolor: "'#ffffff'"
            color: "'#111827'"
            fontSize: 8
            position: l

        # ---------------------------
        # RÓTULOS DAS FREQUÊNCIAS (f_i)
        # mostrados no topo de cada barra
        # ---------------------------
        - Segment:
            a: [1, params.x_1]
            b: [1, params.x_1]
            color: colors.ink
            label:
              text: "`Nota=${params.x_1.toFixed(1)}`"
              position: t
              fontSize: 8

        - Segment:
            a: [2, params.x_2]
            b: [2, params.x_2]
            color: colors.ink
            label:
              text: "`Nota=${params.x_2.toFixed(1)}`"
              position: t
              fontSize: 8

        - Segment:
            a: [3, params.x_3]
            b: [3, params.x_3]
            color: colors.ink
            label:
              text: "`Nota=${params.x_3.toFixed(1)}`"
              position: t
              fontSize: 8

        - Segment:
            a: [4, params.x_4]
            b: [4, params.x_4]
            color: colors.ink
            label:
              text: "`Nota=${params.x_4.toFixed(1)}`"
              position: t
              fontSize: 8



        # ---------------------------
        # RÓTULOS NO EIXO X (ÍNDICE DO VALOR)
        # ---------------------------
        - Label:
            coordinates: [1,0]
            text: "`\\\\mathbf{Matemática}\\\\\\\\ w_{1} = ${params.w_1.toFixed(2)}`"
            bgcolor: "'#ffffff'"
            color: "'#111827'"
            fontSize: 9
            position: t
        - Label:
            coordinates: [2,0]
            text: "`\\\\mathbf{Estatística}\\\\\\\\ w_{2} = ${params.w_2.toFixed(2)}`"
            bgcolor: "'#ffffff'"
            color: "'#111827'"
            fontSize: 9
            position: t
        - Label:
            coordinates: [3,0]
            text: "`\\\\mathbf{História}\\\\\\\\ w_{3} = ${params.w_3.toFixed(2)}`"
            bgcolor: "'#ffffff'"
            color: "'#111827'"
            fontSize: 9
            position: t
        - Label:
            coordinates: [4,0]
            text: "`\\\\mathbf{Ed.Física}\\\\\\\\ w_{4} = ${params.w_4.toFixed(2)}`"
            bgcolor: "'#ffffff'"
            color: "'#111827'"
            fontSize: 9
            position: t

        #Grade
        - Segment:
            a: [0, 2]
            b: [5, 2]
            color: grey
            strokeWidth: 1
            lineStyle: dashed

        - Segment:
            a: [0, 4]
            b: [5, 4]
            color: grey
            strokeWidth: 1
            lineStyle: dashed

        - Segment:
            a: [0, 6]
            b: [5, 6]
            color: grey
            strokeWidth: 1
            lineStyle: dashed

        - Segment:
            a: [0, 8]
            b: [5, 8]
            color: grey
            strokeWidth: 1
            lineStyle: dashed

        - Segment:
            a: [0, 10]
            b: [5, 10]
            color: grey
            strokeWidth: 1
            lineStyle: dashed
        - Segment:
            a: [0, 0.3]
            b: [5, 0.3]
            color: black
            strokeWidth: 1
            lineStyle: solid
    sidebar:
      triggerWidth: 9999
      controls:
      - title: Ajuste os pesos de cada Disciplina
        sliders:
        - param: w_1
          label: 'w_{1}'
        - param: w_2
          label: 'w_2'
        - param: w_3
          label: 'w_{3}'
        - param: w_4
          label: 'w_{4}'